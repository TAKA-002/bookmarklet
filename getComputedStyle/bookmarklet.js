javascript:(()=>{if(confirm("このページの全スタイルを取得してJSONファイルをダウンロードしますか？")){class PageStyle{constructor(){this.allDom=document.querySelectorAll("*");this.excludeProperties=["font-family"];this.excludeTags=["html","head","meta","link","title","style","script","noscript"];this.getComputedStyleInit()}getComputedStyleInit(){const e={};this.allDom.forEach((t,n)=>{if(!this.filterTargetTag(t)){const o=`${this.createElIdentification(t)}__[${n}]`;e[o]=this.getComputedStyleEachEl(t)}});const t=JSON.stringify(e,null,2),n=this.createFileName();this.downloadJsonFile(t,n)}filterTargetTag(e){return this.excludeTags.includes(e.tagName.toLowerCase())}getComputedStyleEachEl(e){const t=window.getComputedStyle(e);let n={};for(let o=0;o<t.length;o++){const r=t[o];if(this.excludeProperties.includes(r))continue;n[r]=t.getPropertyValue(r)}return n}createElIdentification(e){const t=e.tagName.toLowerCase(),n=e.id?`#${e.id}`:"",o=e.classList.length>0?`.${[...e.classList].join(".")}`:"";return`${t}${n}${o}`}createFileName(){const e=window.location.hostname.split(".").join("-"),[t,n]=new Date().toLocaleString({timeZone:"Asia/Tokyo"}).split(" "),o=`${t.replaceAll("/","-")}T${n.replaceAll(":","-")}`;return`styles_${e}_${o}.json`}downloadJsonFile(e,t){const n=new Blob([e],{type:"application/json"}),o=URL.createObjectURL(n),r=document.createElement("a");r.href=o;r.download=t;document.body.appendChild(r);r.click();document.body.removeChild(r);URL.revokeObjectURL(o)}}new PageStyle()}})();